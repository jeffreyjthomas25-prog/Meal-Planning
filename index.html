<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>🍴 Recipe Book & Meal Planner</title>
<style>
  body { font-family: 'Poppins', sans-serif; background: linear-gradient(180deg,#fffbe6,#ffe8ec); margin:0; color:#333; }
  header { background:#ff6b6b; color:white; text-align:center; padding:1.5rem; font-size:1.8rem; }
  nav { display:flex; justify-content:center; background:#ffb6b9; padding:0.6rem; gap:1rem; flex-wrap:wrap; }
  nav button { background:white; border:none; padding:0.7rem 1.3rem; border-radius:25px; cursor:pointer; font-weight:600; transition:0.3s; }
  nav button:hover { background:#fff7f0; transform:scale(1.05); }
  .container { width:90%; max-width:900px; margin:2rem auto; background:white; padding:2rem; border-radius:15px; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
  h2 { text-align:center; color:#ff6b6b; margin-bottom:1rem; }
  input, textarea, button { display:block; width:100%; margin:0.5rem 0; padding:0.7rem; border-radius:8px; border:1px solid #ddd; }
  button { background:#ff6b6b; color:white; font-weight:bold; cursor:pointer; border:none; }
  button:hover { background:#ff8585; }
  .recipe-card { border:1px solid #eee; border-radius:10px; padding:1rem; margin:1rem 0; background:#fffaf8; cursor:grab; }
  .recipe-card img { width:100%; border-radius:10px; }
  .calendar { display:grid; grid-template-columns:repeat(7,1fr); gap:8px; margin-top:20px; }
  .day { border:2px dashed #ff6b6b; min-height:120px; border-radius:8px; padding:5px; background:#fff7f0; }
  .day h4 { text-align:center; color:#ff6b6b; margin:0 0 5px 0; }
  .draggable { cursor:grab; background:#ff9aa2; color:white; padding:4px 6px; border-radius:6px; margin:3px 0; }
</style>
</head>
<body>

<header>🍓 My Recipe Book & Meal Planner 🍕</header>

<nav>
  <button onclick="showSection('home')">Home</button>
  <button onclick="showSection('add')">Add Recipe</button>
  <button onclick="showSection('book')">Recipe Book</button>
  <button onclick="showSection('meal')">Meal Planner</button>
</nav>

<div class="container">

  <!-- Home Overview -->
  <section id="home-section">
    <h2>Welcome to Your Digital Kitchen!</h2>
    <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=900&q=80" alt="Delicious food">
    <p style="text-align:center; font-size:1.1rem;">
      🍴 Keep track of your favorite recipes and plan your weekly meals.  
      📖 <b>Recipe Book:</b> View all your recipes with images and instructions.  
      <br>
      📅 <b>Meal Planner:</b> Drag and drop recipes into your weekly calendar to plan your meals.  
      🥳 Save, organize, and share your culinary creations all in one place!
    </p>
  </section>

  <!-- Add Recipe -->
  <section id="add-section" class="hidden">
    <h2>Add a Recipe</h2>
    <input id="title" placeholder="Recipe title" />
    <textarea id="ingredients" placeholder="Ingredients (comma separated)"></textarea>
    <textarea id="instructions" placeholder="Instructions"></textarea>
    <button onclick="addRecipe()">Add Recipe 🍳</button>
  </section>

  <!-- Recipe Book -->
  <section id="book-section" class="hidden">
    <h2>Your Recipe Book 📖</h2>
    <div id="recipes"></div>
  </section>

  <!-- Meal Planner -->
  <section id="meal-section" class="hidden">
    <h2>Weekly Meal Planner 🥗</h2>
    <p style="text-align:center;">Drag recipes below into each day. Right-click to remove.</p>
    <div class="calendar" id="calendar"></div>
    <h3>Your Recipes:</h3>
    <div id="recipe-pool"></div>
    <button onclick="sharePlan()">Download Plan as Image</button>
  </section>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
let recipes = JSON.parse(localStorage.getItem('recipes')) || [];
let mealPlan = JSON.parse(localStorage.getItem('mealPlan')) || {};

function saveData() {
  localStorage.setItem('recipes', JSON.stringify(recipes));
  localStorage.setItem('mealPlan', JSON.stringify(mealPlan));
}

function showSection(id) {
  ['home','add','book','meal'].forEach(sec => document.getElementById(sec+'-section').classList.add('hidden'));
  document.getElementById(id+'-section').classList.remove('hidden');
  if(id==='book') displayRecipes();
  if(id==='meal') renderMealPlanner();
}

// Add Recipe
function addRecipe() {
  const titleV = document.getElementById('title').value.trim();
  const ingredientsV = document.getElementById('ingredients').value.trim();
  const instructionsV = document.getElementById('instructions').value.trim();
  if(!titleV) return alert("Enter a title!");
  const recipe = {title:titleV, ingredients:ingredientsV, instructions:instructionsV, image:`https://source.unsplash.com/600x400/?food,${encodeURIComponent(titleV)}`};
  recipes.push(recipe);
  saveData();
  displayRecipes();
  document.getElementById('title').value='';
  document.getElementById('ingredients').value='';
  document.getElementById('instructions').value='';
}

// Display recipes in Recipe Book
function displayRecipes() {
  const container = document.getElementById('recipes');
  container.innerHTML='';
  recipes.forEach((r,i)=>{
    const div=document.createElement('div');
    div.className='recipe-card';
    div.innerHTML=`<img src="${r.image}" alt="${r.title}"><h3>${r.title}</h3>
      <p><b>Ingredients:</b> ${r.ingredients}</p>
      <p><b>Instructions:</b> ${r.instructions}</p>
      <button onclick="deleteRecipe(${i})">Delete</button>`;
    container.appendChild(div);
  });
}

// Delete recipe
function deleteRecipe(i){
  recipes.splice(i,1);
  saveData();
  displayRecipes();
  renderMealPlanner();
}

// Render Meal Planner
function renderMealPlanner(){
  const calendar=document.getElementById('calendar');
  calendar.innerHTML='';
  const days=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];
  days.forEach(day=>{
    const div=document.createElement('div');
    div.className='day';
    div.dataset.day=day;
    div.innerHTML=`<h4>${day}</h4>`;
    const meals=mealPlan[day]||[];
    meals.forEach(id=>{
      const r=recipes.find(rec=>rec.title===id);
      if(r){
        const card=document.createElement('div');
        card.className='draggable';
        card.textContent=r.title;
        card.oncontextmenu=e=>{e.preventDefault(); removeMeal(day,r.title);};
        div.appendChild(card);
      }
    });
    div.addEventListener('dragover',e=>e.preventDefault());
    div.addEventListener('drop', handleDrop);
    calendar.appendChild(div);
  });
  // Recipe Pool
  const pool=document.getElementById('recipe-pool');
  pool.innerHTML='';
  recipes.forEach(r=>{
    const div=document.createElement('div');
    div.className='draggable';
    div.textContent=r.title;
    div.draggable=true;
    div.addEventListener('dragstart', handleDragStart);
    pool.appendChild(div);
  });
}

// Drag & Drop
function handleDragStart(e){ e.dataTransfer.setData('text/plain', e.target.textContent); }
function handleDrop(e){
  const recipeName=e.dataTransfer.getData('text/plain');
  const day=e.currentTarget.dataset.day;
  if(!mealPlan[day]) mealPlan[day]=[];
  if(!mealPlan[day].includes(recipeName)) mealPlan[day].push(recipeName);
  saveData();
  renderMealPlanner();
}
function removeMeal(day,name){
  mealPlan[day]=mealPlan[day].filter(r=>r!==name);
  saveData();
  renderMealPlanner();
}

// Share Meal Plan as Image
function sharePlan(){
  html2canvas(document.getElementById('calendar')).then(canvas=>{
    const link=document.createElement('a');
    link.download='meal-plan.png';
    link.href=canvas.toDataURL();
    link.click();
  });
}

// Initialize
showSection('home');
</script>
</body>
</html>
