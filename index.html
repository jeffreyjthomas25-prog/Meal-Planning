<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meal Planner & Recipe Book</title>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background: #f0f4f8;
    margin: 0;
    color: #333;
  }
  nav {
    background: #1e3a8a;
    color: white;
    padding: 12px 0;
    text-align: center;
  }
  nav a {
    color: white;
    margin: 0 15px;
    text-decoration: none;
    font-weight: bold;
  }
  nav a.active { text-decoration: underline; }
  .container {
    max-width: 900px;
    margin: 30px auto;
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    padding: 25px;
  }
  h1, h2 { text-align: center; color: #1e3a8a; }
  .hidden { display: none; }

  input, textarea {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
    border: 1px solid #ccc;
    border-radius: 5px;
  }
  button {
    background: #2563eb;
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 6px;
    cursor: pointer;
    margin-top: 10px;
  }
  button:hover { background: #1d4ed8; }
  ul { list-style: none; padding: 0; }
  li {
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 6px;
    margin-bottom: 8px;
    padding: 8px 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .card {
    background: #f1f5f9;
    padding: 5px 8px;
    border-radius: 6px;
    margin: 5px 0;
  }
  /* Calendar styling */
  .calendar {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 8px;
    margin-top: 20px;
  }
  .day {
    background: #e2e8f0;
    border-radius: 6px;
    min-height: 140px;
    padding: 8px;
  }
  .day h4 {
    text-align: center;
    background: #1e3a8a;
    color: white;
    border-radius: 4px;
    padding: 4px;
    margin-top: 0;
  }
  .draggable {
    background: #3b82f6;
    color: white;
    border-radius: 5px;
    padding: 5px;
    margin-top: 5px;
    cursor: grab;
  }
</style>
</head>
<body>
<nav>
  <a href="#" id="nav-home" onclick="showSection('home')">Home</a>
  <a href="#" id="nav-add" onclick="showSection('add')">Add Recipe</a>
  <a href="#" id="nav-book" onclick="showSection('book')">Recipe Book</a>
  <a href="#" id="nav-meal" onclick="showSection('meal')">Meal Planner</a>
</nav>

<div class="container">

  <!-- Home -->
  <section id="home-section">
    <h1>üçΩÔ∏è Recipe Book & Weekly Meal Planner</h1>
    <p style="text-align:center;">Save recipes and plan your meals for the week!</p>
  </section>

  <!-- Add Recipe -->
  <section id="add-section" class="hidden">
    <h2>Add Recipe</h2>
    <form id="add-form">
      <label>Title</label>
      <input type="text" id="add-title" required>
      <label>Ingredients (one per line)</label>
      <textarea id="add-ingredients" rows="4" required></textarea>
      <label>Instructions</label>
      <textarea id="add-instructions" rows="5" required></textarea>
      <button type="submit">Add Recipe</button>
    </form>
  </section>

  <!-- Recipe Book -->
  <section id="book-section" class="hidden">
    <h2>Recipe Book</h2>
    <ul id="recipe-list"></ul>
    <div id="no-recipes" style="text-align:center;color:#777;">No recipes yet. Add one above.</div>
  </section>

  <!-- Meal Planner -->
  <section id="meal-section" class="hidden">
    <h2>Weekly Meal Planner</h2>
    <p style="text-align:center;">Drag recipes from below into your weekly calendar. Right-click a meal to remove it.</p>

    <div class="calendar" id="calendar">
      <div class="day" data-day="Monday"><h4>Monday</h4></div>
      <div class="day" data-day="Tuesday"><h4>Tuesday</h4></div>
      <div class="day" data-day="Wednesday"><h4>Wednesday</h4></div>
      <div class="day" data-day="Thursday"><h4>Thursday</h4></div>
      <div class="day" data-day="Friday"><h4>Friday</h4></div>
      <div class="day" data-day="Saturday"><h4>Saturday</h4></div>
      <div class="day" data-day="Sunday"><h4>Sunday</h4></div>
    </div>

    <h3 style="margin-top:30px;">Your Recipes</h3>
    <div id="recipe-pool"></div>
    <button onclick="clearCalendar()">Clear Calendar</button>
  </section>

</div>

<script>
  let recipes = [];
  let mealPlan = {}; // { Monday: [recipeId,...], Tuesday: [...] }

  // Load recipes & meals from localStorage
  function loadData() {
    recipes = JSON.parse(localStorage.getItem('recipes')) || [];
    mealPlan = JSON.parse(localStorage.getItem('mealPlan')) || {};
  }
  function saveRecipes() { localStorage.setItem('recipes', JSON.stringify(recipes)); }
  function saveMealPlan() { localStorage.setItem('mealPlan', JSON.stringify(mealPlan)); }

  // Navigation
  function showSection(name) {
    ['home','add','book','meal'].forEach(s => {
      document.getElementById(s+'-section').classList.add('hidden');
      document.getElementById('nav-'+s)?.classList.remove('active');
    });
    document.getElementById(name+'-section').classList.remove('hidden');
    document.getElementById('nav-'+name)?.classList.add('active');
    if(name==='book') renderBook();
    if(name==='meal') renderMealPlanner();
  }

  // Add Recipe
  document.getElementById('add-form').addEventListener('submit', e => {
    e.preventDefault();
    const title = document.getElementById('add-title').value.trim();
    const ingredients = document.getElementById('add-ingredients').value.trim();
    const instructions = document.getElementById('add-instructions').value.trim();
    if(!title || !ingredients || !instructions) return;
    const newRecipe = { id: Date.now(), title, ingredients, instructions };
    recipes.push(newRecipe);
    saveRecipes();
    e.target.reset();
    alert("Recipe added!");
    showSection('book');
  });

  // Render Recipe Book
  function renderBook() {
    loadData();
    const list = document.getElementById('recipe-list');
    list.innerHTML = '';
    if (recipes.length === 0) {
      document.getElementById('no-recipes').style.display = 'block';
      return;
    }
    document.getElementById('no-recipes').style.display = 'none';
    recipes.forEach(r => {
      const li = document.createElement('li');
      li.innerHTML = `<span>${r.title}</span>
        <button onclick="deleteRecipe(${r.id})">Delete</button>`;
      list.appendChild(li);
    });
  }

  function deleteRecipe(id) {
    if(confirm('Delete this recipe?')) {
      recipes = recipes.filter(r => r.id !== id);
      saveRecipes();
      renderBook();
      // Remove from meal plan if exists
      Object.keys(mealPlan).forEach(day => {
        mealPlan[day] = mealPlan[day].filter(i => i !== id);
      });
      saveMealPlan();
    }
  }

  // Meal Planner
  function renderMealPlanner() {
    loadData();
    const pool = document.getElementById('recipe-pool');
    pool.innerHTML = '';
    if(recipes.length === 0){
      pool.innerHTML = "<p>No recipes yet. Add some first!</p>";
    } else {
      recipes.forEach(r => {
        const div = document.createElement('div');
        div.className = 'draggable';
        div.textContent = r.title;
        div.draggable = true;
        div.dataset.id = r.id;
        div.addEventListener('dragstart', handleDragStart);
        pool.appendChild(div);
      });
    }

    document.querySelectorAll('.day').forEach(day => {
      day.innerHTML = `<h4>${day.dataset.day}</h4>`; // clear old meals
      const dayMeals = mealPlan[day.dataset.day] || [];
      dayMeals.forEach(rid => {
        const recipe = recipes.find(r => r.id == rid);
        if(recipe){
          const card = document.createElement('div');
          card.className = 'card';
          card.textContent = recipe.title;
          card.oncontextmenu = (e) => {
            e.preventDefault();
            removeMeal(day.dataset.day, rid);
          };
          day.appendChild(card);
        }
      });
      day.addEventListener('dragover', e => e.preventDefault());
      day.addEventListener('drop', handleDrop);
    });
  }

  function handleDragStart(e) {
    e.dataTransfer.setData('text/plain', e.target.dataset.id);
  }

  function handleDrop(e) {
    const recipeId = parseInt(e.dataTransfer.getData('text/plain'));
    const day = e.currentTarget.dataset.day;
    if(!mealPlan[day]) mealPlan[day] = [];
    mealPlan[day].push(recipeId);
    saveMealPlan();
    renderMealPlanner();
  }

  function removeMeal(day, recipeId){
    mealPlan[day] = mealPlan[day].filter(id => id !== recipeId);
    saveMealPlan();
    renderMealPlanner();
  }

  function clearCalendar(){
    if(confirm("Clear all meals from the calendar?")){
      mealPlan = {};
      saveMealPlan();
      renderMealPlanner();
    }
  }

  // Init
  loadData();
  showSection('home');
</script>
</body>
</html>
